# -*- coding: utf-8 -*-
import re
import os
import csv
import time
import json
import random
import logging
import traceback
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.remote.remote_connection import LOGGER
from selenium.webdriver.chrome.options import Options
from webdriver_manager.chrome import ChromeDriverManager
import scrapy
from scrapy.http import Request
LOGGER.setLevel(logging.WARNING)

base_dir = os.path.dirname(os.path.abspath(__file__))

HTTP_PROXIES = [
  "http://192.144.24.145:8800",
  "http://192.144.27.35:8800",
  "http://192.144.27.120:8800",
  "http://192.144.24.71:8800",
  "http://109.196.168.145:8800",
  "http://194.55.82.212:8800",
  "http://192.144.27.153:8800",
  "http://196.18.92.68:8800",
  "http://192.144.24.148:8800",
  "http://188.119.89.230:8800",
  "http://194.76.33.140:8800",
  "http://196.18.92.51:8800",
  "http://109.196.171.206:8800",
  "http://109.196.168.236:8800",
  "http://192.144.24.67:8800",
  "http://196.18.94.46:8800",
  "http://194.55.82.15:8800",
  "http://196.18.94.58:8800",
  "http://196.18.94.112:8800",
  "http://192.144.24.65:8800",
  "http://192.144.27.58:8800",
  "http://192.144.24.184:8800",
  "http://192.144.27.154:8800",
  "http://194.4.170.54:8800",
  "http://192.144.27.162:8800",
  "http://192.144.24.107:8800",
  "http://192.144.24.94:8800",
  "http://192.144.27.226:8800",
  "http://188.119.89.222:8800",
  "http://192.144.27.99:8800",
  "http://196.18.94.76:8800",
  "http://194.76.33.241:8800",
  "http://196.18.94.168:8800",
  "http://196.18.92.218:8800",
  "http://194.55.82.121:8800",
  "http://192.144.24.28:8800",
  "http://194.4.170.208:8800",
  "http://192.144.24.138:8800",
  "http://196.18.94.156:8800",
  "http://196.18.92.205:8800",
  "http://196.18.94.175:8800",
  "http://192.144.24.244:8800",
  "http://192.144.27.128:8800",
  "http://194.4.170.23:8800",
  "http://194.76.33.102:8800",
  "http://194.76.33.206:8800",
  "http://196.18.92.21:8800",
  "http://192.144.27.178:8800",
  "http://196.18.94.249:8800",
  "http://194.76.33.38:8800",
  "http://192.144.27.11:8800",
  "http://194.4.170.134:8800",
  "http://192.144.24.109:8800",
  "http://196.18.92.41:8800",
  "http://109.196.171.152:8800",
  "http://196.18.92.83:8800",
  "http://196.18.92.238:8800",
  "http://196.18.92.106:8800",
  "http://194.76.33.158:8800",
  "http://196.18.92.183:8800",
  "http://196.18.92.245:8800",
  "http://196.18.94.31:8800",
  "http://192.144.24.220:8800",
  "http://192.144.24.204:8800",
  "http://196.18.92.110:8800",
  "http://194.55.82.184:8800",
  "http://194.4.170.67:8800",
  "http://109.196.168.149:8800",
  "http://192.144.24.101:8800",
  "http://192.144.27.142:8800",
  "http://196.18.94.65:8800",
  "http://188.119.89.133:8800",
  "http://188.119.89.172:8800",
  "http://109.196.171.239:8800",
  "http://109.196.168.72:8800",
  "http://192.144.24.60:8800",
  "http://109.196.168.37:8800",
  "http://188.119.89.75:8800",
  "http://192.144.24.136:8800",
  "http://192.144.27.88:8800",
  "http://188.119.89.135:8800",
  "http://109.196.171.128:8800",
  "http://196.18.94.188:8800",
  "http://109.196.171.111:8800",
  "http://192.144.27.54:8800",
  "http://192.144.27.177:8800",
  "http://194.76.33.29:8800",
  "http://192.144.24.251:8800",
  "http://188.119.89.188:8800",
  "http://192.144.24.233:8800",
  "http://196.18.92.154:8800",
  "http://196.18.94.97:8800",
  "http://196.18.94.163:8800",
  "http://192.144.24.248:8800",
  "http://192.144.24.38:8800",
  "http://192.144.27.74:8800",
  "http://188.119.89.101:8800",
  "http://194.76.33.197:8800",
  "http://194.76.33.128:8800",
  "http://192.144.24.121:8800",
  "http://196.18.94.122:8800",
  "http://196.18.92.19:8800",
  "http://109.196.171.79:8800",
  "http://194.4.170.239:8800",
  "http://196.18.92.175:8800",
  "http://109.196.171.243:8800",
  "http://188.119.89.206:8800",
  "http://188.119.89.29:8800",
  "http://196.18.92.13:8800",
  "http://196.18.94.4:8800",
  "http://196.18.92.207:8800",
  "http://196.18.94.114:8800",
  "http://196.18.92.47:8800",
  "http://192.144.24.181:8800",
  "http://194.76.33.224:8800",
  "http://192.144.24.196:8800",
  "http://196.18.92.224:8800",
  "http://109.196.168.3:8800",
  "http://194.4.170.75:8800",
  "http://196.18.94.146:8800",
  "http://196.18.94.186:8800",
  "http://196.18.94.251:8800",
  "http://192.144.24.24:8800",
  "http://192.144.24.132:8800",
  "http://192.144.24.246:8800",
  "http://192.144.24.3:8800",
  "http://109.196.171.253:8800",
  "http://188.119.89.144:8800",
  "http://196.18.92.214:8800",
  "http://194.55.82.196:8800",
  "http://192.144.27.218:8800",
  "http://194.4.170.6:8800",
  "http://196.18.92.184:8800",
  "http://188.119.89.217:8800",
  "http://109.196.168.4:8800",
  "http://109.196.168.93:8800",
  "http://192.144.24.130:8800",
  "http://188.119.89.18:8800",
  "http://192.144.27.72:8800",
  "http://194.4.170.154:8800",
  "http://192.144.27.37:8800",
  "http://188.119.89.4:8800",
  "http://188.119.89.218:8800",
  "http://196.18.92.127:8800",
  "http://196.18.92.165:8800",
  "http://192.144.24.236:8800",
  "http://194.76.33.227:8800",
  "http://188.119.89.94:8800",
  "http://196.18.92.130:8800",
  "http://196.18.92.141:8800",
  "http://196.18.92.250:8800",
  "http://196.18.94.123:8800",
  "http://196.18.92.15:8800",
  "http://196.18.92.30:8800",
  "http://196.18.92.203:8800",
  "http://192.144.27.94:8800",
  "http://192.144.27.181:8800",
  "http://194.55.82.116:8800",
  "http://196.18.92.252:8800",
  "http://192.144.24.21:8800",
  "http://194.55.82.72:8800",
  "http://188.119.89.118:8800",
  "http://196.18.92.146:8800",
  "http://194.4.170.175:8800",
  "http://196.18.94.22:8800",
  "http://194.76.33.92:8800",
  "http://194.76.33.136:8800",
  "http://196.18.92.3:8800",
  "http://192.144.24.190:8800",
  "http://109.196.171.103:8800",
  "http://192.144.24.158:8800",
  "http://192.144.27.193:8800",
  "http://194.4.170.33:8800",
  "http://188.119.89.146:8800",
  "http://194.4.170.53:8800",
  "http://194.4.170.72:8800",
  "http://192.144.27.78:8800",
  "http://192.144.24.153:8800",
  "http://196.18.94.196:8800",
  "http://196.18.92.100:8800",
  "http://109.196.171.172:8800",
  "http://196.18.94.132:8800",
  "http://196.18.92.209:8800",
  "http://192.144.27.235:8800",
  "http://196.18.92.226:8800",
  "http://192.144.27.110:8800",
  "http://192.144.24.205:8800",
  "http://196.18.94.237:8800",
  "http://196.18.94.214:8800",
  "http://192.144.27.157:8800",
  "http://192.144.27.48:8800",
  "http://196.18.92.163:8800",
  "http://194.76.33.58:8800",
  "http://196.18.92.4:8800",
  "http://188.119.89.178:8800",
  "http://194.4.170.92:8800",
  "http://192.144.24.234:8800",
  "http://188.119.89.17:8800",
  "http://194.55.82.190:8800",
  "http://196.18.92.167:8800",
  "http://196.18.94.189:8800",
  "http://194.4.170.188:8800",
  "http://192.144.27.136:8800",
  "http://192.144.27.50:8800",
  "http://192.144.24.123:8800",
  "http://192.144.24.240:8800",
  "http://196.18.94.87:8800",
  "http://194.76.33.138:8800",
  "http://188.119.89.10:8800",
  "http://192.144.27.26:8800",
  "http://192.144.27.224:8800",
  "http://196.18.94.110:8800",
  "http://188.119.89.166:8800",
  "http://196.18.94.107:8800",
  "http://109.196.168.190:8800",
  "http://192.144.24.35:8800",
  "http://192.144.24.147:8800",
  "http://192.144.27.248:8800",
  "http://109.196.171.212:8800",
  "http://196.18.94.240:8800",
  "http://194.55.82.253:8800",
  "http://196.18.94.7:8800",
  "http://188.119.89.48:8800",
  "http://188.119.89.254:8800",
  "http://109.196.168.42:8800",
  "http://192.144.24.9:8800",
  "http://192.144.27.147:8800",
  "http://196.18.92.229:8800",
  "http://192.144.27.85:8800",
  "http://196.18.92.244:8800",
  "http://192.144.24.66:8800",
  "http://196.18.92.197:8800",
  "http://192.144.27.205:8800",
  "http://196.18.92.234:8800",
  "http://196.18.94.245:8800",
  "http://196.18.92.251:8800",
  "http://188.119.89.228:8800",
  "http://188.119.89.9:8800",
  "http://192.144.24.1:8800",
  "http://188.119.89.192:8800",
  "http://188.119.89.183:8800",
  "http://188.119.89.43:8800",
  "http://188.119.89.124:8800",
  "http://188.119.89.243:8800",
  "http://192.144.27.163:8800",
  "http://192.144.24.225:8800",
  "http://192.144.27.103:8800",
  "http://194.4.170.113:8800",
  "http://188.119.89.219:8800",
  "http://194.55.82.123:8800",
  "http://196.18.94.117:8800",
  "http://196.18.94.79:8800",
  "http://109.196.171.42:8800",
  "http://192.144.27.246:8800",
  "http://196.18.94.177:8800",
  "http://196.18.92.246:8800",
  "http://196.18.92.169:8800",
  "http://194.55.82.240:8800",
  "http://196.18.92.82:8800",
  "http://194.55.82.204:8800",
  "http://192.144.24.85:8800",
  "http://196.18.92.101:8800",
  "http://194.55.82.74:8800",
  "http://109.196.171.139:8800",
  "http://196.18.92.198:8800",
  "http://196.18.92.18:8800",
  "http://194.55.82.89:8800",
  "http://188.119.89.241:8800",
  "http://188.119.89.231:8800",
  "http://194.4.170.189:8800",
  "http://192.144.24.129:8800",
  "http://196.18.94.200:8800",
  "http://194.4.170.166:8800",
  "http://192.144.24.134:8800",
  "http://188.119.89.164:8800",
  "http://196.18.94.213:8800",
  "http://194.55.82.119:8800",
  "http://196.18.92.139:8800",
  "http://196.18.94.94:8800",
  "http://192.144.27.250:8800",
  "http://196.18.92.211:8800",
  "http://188.119.89.85:8800",
  "http://196.18.94.124:8800",
  "http://192.144.27.45:8800",
  "http://109.196.171.174:8800",
  "http://192.144.27.255:8800",
  "http://192.144.27.212:8800",
  "http://109.196.168.56:8800",
  "http://192.144.24.126:8800",
  "http://188.119.89.122:8800",
  "http://196.18.92.67:8800",
  "http://188.119.89.142:8800",
  "http://192.144.27.161:8800",
  "http://196.18.92.81:8800",
  "http://196.18.92.185:8800",
  "http://194.55.82.181:8800",
  "http://188.119.89.176:8800",
  "http://196.18.92.192:8800",
  "http://196.18.94.42:8800",
  "http://109.196.168.249:8800",
  "http://192.144.27.201:8800",
  "http://188.119.89.1:8800",
  "http://188.119.89.244:8800",
  "http://196.18.92.73:8800",
  "http://196.18.92.235:8800",
  "http://109.196.171.248:8800",
  "http://196.18.92.42:8800",
  "http://109.196.168.36:8800",
  "http://196.18.92.177:8800",
  "http://194.76.33.176:8800",
  "http://192.144.24.186:8800",
  "http://196.18.94.70:8800",
  "http://196.18.94.233:8800",
  "http://188.119.89.31:8800",
  "http://196.18.92.230:8800",
  "http://194.4.170.86:8800",
  "http://194.4.170.127:8800",
  "http://109.196.168.162:8800",
  "http://188.119.89.223:8800",
  "http://194.4.170.79:8800",
  "http://194.4.170.198:8800",
  "http://196.18.92.200:8800",
  "http://188.119.89.74:8800",
  "http://196.18.92.32:8800",
  "http://194.4.170.104:8800",
  "http://192.144.27.166:8800",
  "http://192.144.24.30:8800",
  "http://109.196.171.52:8800",
  "http://196.18.94.143:8800",
  "http://109.196.168.125:8800",
  "http://196.18.94.108:8800",
  "http://196.18.92.132:8800",
  "http://196.18.92.158:8800",
  "http://192.144.24.191:8800",
  "http://188.119.89.153:8800",
  "http://196.18.94.36:8800",
  "http://188.119.89.216:8800",
  "http://109.196.171.14:8800",
  "http://109.196.171.214:8800",
  "http://109.196.171.23:8800",
  "http://109.196.168.131:8800",
  "http://196.18.92.122:8800",
  "http://188.119.89.13:8800",
  "http://196.18.94.78:8800",
  "http://192.144.27.239:8800",
  "http://109.196.171.195:8800",
  "http://192.144.24.142:8800",
  "http://196.18.94.173:8800",
  "http://192.144.27.189:8800",
  "http://192.144.27.107:8800",
  "http://192.144.24.55:8800",
  "http://188.119.89.19:8800",
  "http://194.55.82.235:8800",
  "http://196.18.92.174:8800",
  "http://196.18.92.138:8800",
  "http://109.196.171.30:8800",
  "http://192.144.24.255:8800",
  "http://196.18.92.70:8800",
  "http://192.144.24.47:8800",
  "http://188.119.89.30:8800",
  "http://109.196.171.59:8800",
  "http://192.144.27.175:8800",
  "http://192.144.24.252:8800",
  "http://196.18.94.120:8800",
  "http://109.196.168.47:8800",
  "http://192.144.27.14:8800",
  "http://192.144.27.7:8800",
  "http://109.196.168.78:8800",
  "http://196.18.92.40:8800",
  "http://192.144.24.68:8800",
  "http://192.144.27.8:8800",
  "http://192.144.27.20:8800",
  "http://188.119.89.12:8800",
  "http://196.18.92.156:8800",
  "http://192.144.27.38:8800",
  "http://194.55.82.197:8800",
  "http://196.18.92.210:8800",
  "http://192.144.27.242:8800",
  "http://192.144.24.253:8800",
  "http://196.18.92.2:8800",
  "http://192.144.27.84:8800",
  "http://188.119.89.234:8800",
  "http://196.18.92.243:8800",
  "http://192.144.27.63:8800",
  "http://192.144.24.11:8800",
  "http://188.119.89.255:8800",
  "http://196.18.94.192:8800",
  "http://192.144.24.131:8800",
  "http://196.18.94.232:8800",
  "http://188.119.89.169:8800",
  "http://196.18.94.85:8800",
  "http://196.18.94.135:8800",
  "http://188.119.89.215:8800",
  "http://196.18.94.130:8800",
  "http://192.144.27.234:8800",
  "http://109.196.168.157:8800",
  "http://192.144.27.190:8800",
  "http://194.4.170.206:8800",
  "http://196.18.92.155:8800",
  "http://196.18.92.36:8800",
  "http://196.18.94.219:8800",
  "http://188.119.89.182:8800",
  "http://194.76.33.230:8800",
  "http://196.18.94.148:8800",
  "http://188.119.89.214:8800",
  "http://194.76.33.178:8800",
  "http://194.55.82.83:8800",
  "http://194.55.82.221:8800",
  "http://192.144.27.195:8800",
  "http://192.144.27.95:8800",
  "http://196.18.94.157:8800",
  "http://196.18.94.12:8800",
  "http://192.144.24.187:8800",
  "http://192.144.27.68:8800",
  "http://192.144.27.9:8800",
  "http://188.119.89.236:8800",
  "http://109.196.168.209:8800",
  "http://196.18.94.167:8800",
  "http://196.18.92.193:8800",
  "http://192.144.24.168:8800",
  "http://196.18.92.180:8800",
  "http://192.144.27.150:8800",
  "http://196.18.92.108:8800",
  "http://109.196.171.216:8800",
  "http://194.76.33.174:8800",
  "http://196.18.94.93:8800",
  "http://194.76.33.69:8800",
  "http://196.18.94.116:8800",
  "http://192.144.27.238:8800",
  "http://196.18.94.30:8800",
  "http://194.4.170.199:8800",
  "http://196.18.94.155:8800",
  "http://109.196.168.119:8800",
  "http://196.18.92.119:8800",
  "http://196.18.92.103:8800",
  "http://192.144.27.47:8800",
  "http://196.18.94.68:8800",
  "http://109.196.168.216:8800",
  "http://194.76.33.59:8800",
  "http://192.144.27.104:8800",
  "http://196.18.94.138:8800",
  "http://192.144.27.187:8800",
  "http://192.144.24.74:8800",
  "http://192.144.27.17:8800",
  "http://196.18.94.172:8800",
  "http://196.18.94.63:8800",
  "http://109.196.168.202:8800",
  "http://192.144.24.104:8800",
  "http://192.144.27.41:8800",
  "http://194.55.82.146:8800",
  "http://192.144.24.57:8800",
  "http://194.76.33.66:8800",
  "http://188.119.89.44:8800",
  "http://196.18.92.29:8800",
  "http://196.18.94.19:8800",
  "http://188.119.89.209:8800",
  "http://192.144.27.79:8800",
  "http://109.196.171.66:8800",
  "http://196.18.92.94:8800",
  "http://188.119.89.73:8800",
  "http://196.18.94.212:8800",
  "http://196.18.94.56:8800",
  "http://196.18.94.72:8800",
  "http://192.144.24.243:8800",
  "http://192.144.27.165:8800",
  "http://109.196.168.168:8800",
  "http://192.144.24.232:8800",
  "http://196.18.94.77:8800",
  "http://196.18.92.153:8800",
  "http://196.18.94.121:8800",
  "http://192.144.24.119:8800",
  "http://196.18.92.78:8800",
  "http://194.55.82.61:8800",
  "http://188.119.89.107:8800",
  "http://196.18.94.162:8800",
  "http://188.119.89.126:8800",
  "http://196.18.94.202:8800",
  "http://188.119.89.187:8800",
  "http://109.196.171.154:8800",
  "http://188.119.89.116:8800",
  "http://196.18.94.234:8800",
  "http://194.76.33.82:8800",
  "http://192.144.27.102:8800",
  "http://194.76.33.78:8800",
  "http://194.55.82.135:8800",
  "http://194.76.33.220:8800",
  "http://109.196.168.88:8800",
  "http://196.18.92.64:8800",
  "http://188.119.89.95:8800",
  "http://192.144.27.243:8800",
  "http://194.4.170.140:8800",
  "http://188.119.89.140:8800",
  "http://194.55.82.40:8800",
  "http://196.18.94.18:8800",
  "http://194.4.170.25:8800",
  "http://192.144.24.26:8800",
  "http://192.144.24.172:8800",
  "http://196.18.92.249:8800",
  "http://192.144.24.198:8800",
  "http://109.196.168.19:8800",
  "http://196.18.94.161:8800",
  "http://196.18.94.185:8800",
  "http://192.144.27.76:8800",
  "http://109.196.171.120:8800",
  "http://192.144.27.252:8800",
  "http://194.4.170.107:8800",
  "http://192.144.27.49:8800",
  "http://196.18.94.3:8800",
  "http://196.18.92.239:8800",
  "http://196.18.94.29:8800",
  "http://192.144.24.182:8800",
  "http://196.18.94.134:8800",
  "http://188.119.89.221:8800",
  "http://192.144.24.254:8800",
  "http://196.18.94.109:8800",
  "http://192.144.27.130:8800",
  "http://109.196.168.233:8800",
  "http://192.144.27.13:8800",
  "http://196.18.94.125:8800",
  "http://196.18.92.74:8800",
  "http://196.18.94.119:8800",
  "http://192.144.27.122:8800",
  "http://192.144.24.93:8800",
  "http://188.119.89.117:8800",
  "http://192.144.24.174:8800",
  "http://194.4.170.156:8800",
  "http://192.144.27.129:8800",
  "http://196.18.94.208:8800",
  "http://196.18.94.147:8800",
  "http://196.18.92.75:8800",
  "http://192.144.27.241:8800",
  "http://196.18.94.244:8800",
  "http://196.18.94.47:8800",
  "http://194.76.33.89:8800",
  "http://196.18.92.53:8800",
  "http://196.18.92.124:8800",
  "http://109.196.168.35:8800",
  "http://192.144.24.200:8800",
  "http://194.55.82.154:8800",
  "http://196.18.94.37:8800",
  "http://196.18.92.241:8800",
  "http://194.55.82.107:8800",
  "http://194.55.82.94:8800",
  "http://188.119.89.151:8800",
  "http://192.144.27.87:8800",
  "http://188.119.89.38:8800",
  "http://192.144.24.14:8800",
  "http://196.18.94.217:8800",
  "http://194.55.82.125:8800",
  "http://192.144.27.46:8800",
  "http://192.144.24.79:8800",
  "http://188.119.89.238:8800",
  "http://194.76.33.175:8800",
  "http://192.144.24.82:8800",
  "http://196.18.92.194:8800",
  "http://192.144.24.99:8800",
  "http://188.119.89.65:8800",
  "http://194.76.33.232:8800",
  "http://192.144.24.201:8800",
  "http://196.18.94.1:8800",
  "http://196.18.92.188:8800",
  "http://192.144.27.66:8800",
  "http://196.18.94.222:8800",
  "http://109.196.168.150:8800",
  "http://194.4.170.2:8800",
  "http://192.144.27.53:8800",
  "http://196.18.92.48:8800",
  "http://192.144.24.161:8800",
  "http://196.18.94.106:8800",
  "http://196.18.92.80:8800",
  "http://196.18.94.104:8800",
  "http://109.196.168.43:8800",
  "http://194.55.82.51:8800",
  "http://196.18.94.44:8800",
  "http://194.55.82.22:8800",
  "http://192.144.24.125:8800",
  "http://188.119.89.109:8800",
  "http://192.144.27.1:8800",
  "http://192.144.24.75:8800",
  "http://196.18.94.2:8800",
  "http://196.18.94.60:8800",
  "http://194.55.82.138:8800",
  "http://109.196.168.142:8800",
  "http://192.144.27.194:8800",
  "http://192.144.24.219:8800",
  "http://196.18.92.126:8800",
  "http://192.144.27.19:8800",
  "http://188.119.89.71:8800",
  "http://196.18.94.198:8800",
  "http://196.18.94.141:8800",
  "http://188.119.89.197:8800",
  "http://192.144.27.196:8800",
  "http://192.144.24.128:8800",
  "http://192.144.24.203:8800",
  "http://109.196.171.107:8800",
  "http://194.4.170.162:8800",
  "http://192.144.27.97:8800",
  "http://196.18.92.61:8800",
  "http://192.144.27.240:8800",
  "http://192.144.27.64:8800",
  "http://188.119.89.66:8800",
  "http://188.119.89.81:8800",
  "http://192.144.27.244:8800",
  "http://196.18.92.137:8800",
  "http://194.4.170.137:8800",
  "http://196.18.94.131:8800",
  "http://188.119.89.186:8800",
  "http://194.55.82.59:8800",
  "http://194.4.170.70:8800",
  "http://188.119.89.16:8800",
  "http://188.119.89.80:8800",
  "http://188.119.89.46:8800",
  "http://196.18.94.215:8800",
  "http://109.196.171.56:8800",
  "http://188.119.89.40:8800",
  "http://188.119.89.171:8800",
  "http://192.144.27.31:8800",
  "http://192.144.27.138:8800",
  "http://188.119.89.229:8800",
  "http://188.119.89.224:8800",
  "http://109.196.171.61:8800",
  "http://192.144.27.229:8800",
  "http://194.55.82.189:8800",
  "http://188.119.89.207:8800",
  "http://194.55.82.231:8800",
  "http://188.119.89.251:8800",
  "http://188.119.89.130:8800",
  "http://192.144.24.95:8800",
  "http://192.144.27.223:8800",
  "http://196.18.92.219:8800",
  "http://194.55.82.82:8800",
  "http://194.4.170.44:8800",
  "http://192.144.27.233:8800",
  "http://196.18.92.17:8800",
  "http://192.144.27.39:8800",
  "http://192.144.24.237:8800",
  "http://192.144.27.228:8800",
  "http://192.144.24.49:8800",
  "http://192.144.24.100:8800",
  "http://192.144.24.6:8800",
  "http://192.144.24.113:8800",
  "http://192.144.24.208:8800",
  "http://196.18.92.63:8800",
  "http://188.119.89.173:8800",
  "http://196.18.92.65:8800",
  "http://188.119.89.3:8800",
  "http://194.76.33.208:8800",
  "http://109.196.171.134:8800",
  "http://196.18.92.88:8800",
  "http://194.55.82.252:8800",
  "http://196.18.94.126:8800",
  "http://192.144.24.115:8800",
  "http://196.18.94.115:8800",
  "http://196.18.92.62:8800",
  "http://192.144.27.77:8800",
  "http://188.119.89.127:8800",
  "http://196.18.92.116:8800",
  "http://196.18.94.128:8800",
  "http://194.76.33.27:8800",
  "http://188.119.89.68:8800",
  "http://192.144.24.226:8800",
  "http://192.144.27.176:8800",
  "http://196.18.94.206:8800",
  "http://188.119.89.213:8800",
  "http://196.18.92.111:8800",
  "http://188.119.89.79:8800",
  "http://188.119.89.37:8800",
  "http://194.55.82.140:8800",
  "http://192.144.27.146:8800",
  "http://188.119.89.239:8800",
  "http://188.119.89.69:8800",
  "http://192.144.27.30:8800",
  "http://196.18.94.64:8800",
  "http://192.144.24.218:8800",
  "http://192.144.24.111:8800",
  "http://196.18.94.207:8800",
  "http://196.18.92.22:8800",
  "http://194.55.82.216:8800",
  "http://196.18.92.160:8800",
  "http://192.144.27.199:8800",
  "http://109.196.168.170:8800",
  "http://194.4.170.186:8800",
  "http://196.18.92.178:8800",
  "http://196.18.92.44:8800",
  "http://109.196.168.123:8800",
  "http://188.119.89.59:8800",
  "http://192.144.24.140:8800",
  "http://192.144.24.27:8800",
  "http://188.119.89.149:8800",
  "http://194.76.33.254:8800",
  "http://192.144.24.42:8800",
  "http://196.18.94.9:8800",
  "http://192.144.24.34:8800",
  "http://196.18.92.225:8800",
  "http://192.144.24.143:8800",
  "http://196.18.94.80:8800",
  "http://194.76.33.68:8800",
  "http://109.196.171.15:8800",
  "http://192.144.27.81:8800",
  "http://109.196.171.237:8800",
  "http://196.18.92.79:8800",
  "http://196.18.94.27:8800",
  "http://196.18.94.170:8800",
  "http://188.119.89.49:8800",
  "http://109.196.168.207:8800",
  "http://192.144.24.163:8800",
  "http://194.76.33.34:8800",
  "http://192.144.24.231:8800",
  "http://196.18.92.152:8800",
  "http://196.18.92.8:8800",
  "http://188.119.89.249:8800",
  "http://188.119.89.129:8800",
  "http://192.144.27.15:8800",
  "http://196.18.94.220:8800",
  "http://109.196.171.215:8800",
  "http://196.18.92.33:8800",
  "http://192.144.27.209:8800",
  "http://188.119.89.143:8800",
  "http://188.119.89.106:8800",
  "http://196.18.92.164:8800",
  "http://192.144.27.133:8800",
  "http://196.18.94.216:8800",
  "http://196.18.94.180:8800",
  "http://192.144.24.116:8800",
  "http://109.196.168.24:8800",
  "http://192.144.24.165:8800",
  "http://196.18.92.39:8800",
  "http://192.144.27.232:8800",
  "http://194.76.33.11:8800",
  "http://109.196.168.61:8800",
  "http://196.18.94.160:8800",
  "http://188.119.89.159:8800",
  "http://192.144.27.40:8800",
  "http://194.76.33.15:8800",
  "http://192.144.24.171:8800",
  "http://196.18.94.20:8800",
  "http://192.144.27.114:8800",
  "http://192.144.27.148:8800",
  "http://192.144.24.73:8800",
  "http://192.144.27.80:8800",
  "http://192.144.24.157:8800",
  "http://196.18.94.221:8800",
  "http://196.18.92.151:8800",
  "http://196.18.92.11:8800",
  "http://194.4.170.228:8800",
  "http://192.144.27.21:8800",
  "http://196.18.94.151:8800",
  "http://109.196.168.14:8800",
  "http://188.119.89.189:8800",
  "http://194.4.170.77:8800",
  "http://188.119.89.198:8800",
  "http://196.18.94.102:8800",
  "http://192.144.27.5:8800",
  "http://109.196.171.88:8800",
  "http://192.144.27.180:8800",
  "http://196.18.94.35:8800",
  "http://194.4.170.240:8800",
  "http://188.119.89.195:8800",
  "http://192.144.24.87:8800",
  "http://196.18.94.149:8800",
  "http://109.196.171.220:8800",
  "http://194.76.33.19:8800",
  "http://188.119.89.185:8800",
  "http://196.18.92.191:8800",
  "http://188.119.89.92:8800",
  "http://194.4.170.203:8800",
  "http://192.144.27.192:8800",
  "http://188.119.89.56:8800",
  "http://188.119.89.103:8800",
  "http://196.18.94.91:8800",
  "http://194.4.170.167:8800",
  "http://109.196.171.53:8800",
  "http://194.76.33.209:8800",
  "http://188.119.89.35:8800",
  "http://192.144.27.131:8800",
  "http://192.144.24.207:8800",
  "http://196.18.94.153:8800",
  "http://188.119.89.20:8800",
  "http://188.119.89.36:8800",
  "http://196.18.92.157:8800",
  "http://188.119.89.253:8800",
  "http://196.18.94.181:8800",
  "http://196.18.92.134:8800",
  "http://192.144.27.140:8800",
  "http://192.144.24.173:8800",
  "http://109.196.171.157:8800",
  "http://196.18.92.50:8800",
  "http://109.196.168.247:8800",
  "http://194.55.82.71:8800",
  "http://196.18.94.49:8800",
  "http://192.144.27.60:8800",
  "http://192.144.27.210:8800",
  "http://194.76.33.111:8800",
  "http://188.119.89.98:8800",
  "http://188.119.89.204:8800",
  "http://194.4.170.89:8800",
  "http://192.144.24.50:8800",
  "http://196.18.92.161:8800",
  "http://192.144.24.249:8800",
  "http://188.119.89.190:8800",
  "http://194.55.82.179:8800",
  "http://196.18.94.159:8800",
  "http://192.144.24.70:8800",
  "http://194.76.33.157:8800",
  "http://196.18.94.11:8800",
  "http://192.144.24.78:8800",
  "http://192.144.24.13:8800",
  "http://188.119.89.175:8800",
  "http://192.144.27.119:8800",
  "http://192.144.24.61:8800",
  "http://196.18.92.58:8800",
  "http://188.119.89.32:8800",
  "http://194.4.170.11:8800",
  "http://196.18.94.24:8800",
  "http://196.18.92.221:8800",
  "http://194.55.82.79:8800",
  "http://196.18.94.203:8800",
  "http://192.144.24.221:8800",
  "http://188.119.89.54:8800",
  "http://188.119.89.27:8800",
  "http://192.144.24.206:8800",
  "http://188.119.89.163:8800",
  "http://196.18.92.76:8800",
  "http://194.4.170.185:8800",
  "http://196.18.94.178:8800",
  "http://188.119.89.5:8800",
  "http://196.18.94.21:8800",
  "http://196.18.94.95:8800",
  "http://196.18.92.34:8800",
  "http://192.144.27.52:8800",
  "http://192.144.27.4:8800",
  "http://109.196.171.16:8800",
  "http://196.18.92.26:8800",
  "http://109.196.171.202:8800",
  "http://192.144.24.72:8800",
  "http://196.18.94.43:8800",
  "http://194.4.170.213:8800",
  "http://194.55.82.166:8800",
  "http://192.144.27.160:8800",
  "http://192.144.24.176:8800",
  "http://109.196.171.110:8800",
  "http://188.119.89.162:8800",
  "http://196.18.92.254:8800",
  "http://196.18.92.84:8800",
  "http://192.144.24.51:8800",
  "http://194.76.33.162:8800",
  "http://188.119.89.2:8800",
  "http://192.144.27.96:8800",
  "http://188.119.89.193:8800",
  "http://109.196.171.146:8800",
  "http://192.144.24.44:8800",
  "http://194.76.33.177:8800",
  "http://194.4.170.12:8800",
  "http://109.196.168.2:8800",
  "http://188.119.89.180:8800",
  "http://188.119.89.161:8800",
  "http://196.18.94.152:8800",
  "http://196.18.92.159:8800",
  "http://192.144.27.134:8800",
  "http://188.119.89.34:8800",
  "http://188.119.89.247:8800",
  "http://109.196.168.140:8800",
  "http://194.4.170.32:8800",
  "http://196.18.94.199:8800",
  "http://192.144.27.55:8800",
  "http://188.119.89.8:8800",
  "http://192.144.24.212:8800",
  "http://194.55.82.241:8800",
  "http://194.76.33.36:8800",
  "http://188.119.89.158:8800",
  "http://196.18.94.73:8800",
  "http://196.18.92.166:8800",
  "http://196.18.94.248:8800",
  "http://192.144.24.96:8800",
  "http://194.76.33.48:8800",
  "http://192.144.24.188:8800",
  "http://192.144.24.156:8800",
  "http://192.144.24.122:8800",
  "http://196.18.92.129:8800",
  "http://109.196.171.93:8800",
  "http://192.144.27.112:8800",
  "http://194.76.33.74:8800",
  "http://188.119.89.211:8800",
  "http://192.144.27.197:8800",
  "http://194.4.170.56:8800",
  "http://194.4.170.63:8800",
  "http://194.4.170.218:8800",
  "http://192.144.27.44:8800",
  "http://109.196.171.242:8800",
  "http://109.196.168.153:8800",
  "http://188.119.89.212:8800",
  "http://192.144.24.31:8800",
  "http://194.55.82.111:8800",
  "http://192.144.24.17:8800",
  "http://194.55.82.117:8800",
  "http://109.196.168.102:8800",
  "http://192.144.27.10:8800",
  "http://109.196.171.181:8800",
  "http://194.55.82.254:8800",
  "http://109.196.168.248:8800",
  "http://196.18.92.102:8800",
  "http://192.144.24.230:8800",
  "http://192.144.24.202:8800",
  "http://196.18.92.96:8800",
  "http://109.196.168.113:8800",
  "http://192.144.24.167:8800",
  "http://109.196.171.97:8800",
  "http://192.144.27.108:8800",
  "http://188.119.89.167:8800",
  "http://196.18.92.147:8800",
  "http://196.18.94.25:8800",
  "http://194.76.33.253:8800",
  "http://196.18.94.66:8800",
  "http://109.196.168.243:8800",
  "http://192.144.27.208:8800",
  "http://196.18.92.171:8800",
  "http://196.18.94.209:8800",
  "http://196.18.92.118:8800",
  "http://192.144.24.154:8800",
  "http://109.196.171.251:8800",
  "http://194.4.170.178:8800",
  "http://109.196.171.124:8800",
  "http://196.18.92.105:8800",
  "http://196.18.92.28:8800",
  "http://194.55.82.26:8800",
  "http://192.144.27.32:8800",
  "http://109.196.168.253:8800",
  "http://196.18.94.13:8800",
  "http://188.119.89.26:8800",
  "http://188.119.89.41:8800",
  "http://188.119.89.245:8800",
  "http://188.119.89.111:8800",
  "http://192.144.27.69:8800",
  "http://194.76.33.199:8800",
  "http://196.18.94.75:8800",
  "http://192.144.24.216:8800",
  "http://192.144.24.37:8800",
  "http://188.119.89.242:8800",
  "http://192.144.24.214:8800",
  "http://109.196.168.22:8800",
  "http://192.144.24.164:8800",
  "http://196.18.94.34:8800",
  "http://192.144.27.221:8800",
  "http://192.144.24.77:8800",
  "http://192.144.27.59:8800",
  "http://188.119.89.121:8800",
  "http://188.119.89.113:8800",
  "http://192.144.24.124:8800",
  "http://196.18.94.176:8800",
  "http://196.18.94.183:8800",
  "http://196.18.94.171:8800",
  "http://192.144.24.15:8800",
  "http://192.144.27.253:8800",
  "http://196.18.92.162:8800",
  "http://194.55.82.122:8800",
  "http://196.18.92.232:8800",
  "http://194.76.33.180:8800",
  "http://196.18.94.197:8800",
  "http://192.144.24.5:8800",
  "http://196.18.94.86:8800",
  "http://192.144.27.172:8800",
  "http://109.196.171.175:8800",
  "http://196.18.92.148:8800",
  "http://188.119.89.99:8800",
  "http://192.144.27.167:8800",
  "http://192.144.24.228:8800",
  "http://192.144.27.33:8800",
  "http://192.144.24.211:8800",
  "http://196.18.94.101:8800",
  "http://188.119.89.137:8800",
  "http://196.18.92.45:8800",
  "http://188.119.89.232:8800",
  "http://192.144.27.247:8800",
  "http://109.196.171.155:8800",
  "http://194.76.33.211:8800",
  "http://192.144.27.144:8800",
  "http://109.196.168.96:8800",
  "http://188.119.89.225:8800",
  "http://196.18.92.201:8800",
  "http://196.18.92.144:8800",
  "http://192.144.27.159:8800",
  "http://194.76.33.23:8800",
  "http://196.18.94.53:8800",
  "http://192.144.27.70:8800",
  "http://192.144.24.149:8800",
  "http://192.144.27.171:8800",
  "http://188.119.89.23:8800",
  "http://188.119.89.28:8800",
  "http://196.18.92.215:8800",
  "http://109.196.171.18:8800",
  "http://192.144.24.83:8800",
  "http://192.144.24.103:8800",
  "http://192.144.24.135:8800",
  "http://194.76.33.143:8800",
  "http://109.196.168.98:8800",
  "http://109.196.168.10:8800",
  "http://194.55.82.120:8800",
  "http://192.144.27.188:8800",
  "http://196.18.92.5:8800",
  "http://194.55.82.153:8800",
]

user_agent_list = [
    'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.1.1 Safari/605.1.15',
    'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:77.0) Gecko/20100101 Firefox/77.0',
    'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.97 Safari/537.36',
    'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:77.0) Gecko/20100101 Firefox/77.0',
    'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.97 Safari/537.36',
]

class AmazonProductSpider(scrapy.Spider):
    name = "AmazonDeals"
    allowed_domains = ["amazon.com"]

    custom_settings = {
        'DOWNLOAD_DELAY': 5,
        "LOG_LEVEL": 'INFO',
    }
    
    def __init__(self):
        self.country = None
        self.search_key = None
        self.page_count = None
        self.get_config()

        if self.search_key:
            if self.country:
                self.result_file = "{}/{}_{}.csv".format(base_dir, re.sub(r"\s+", "_", self.search_key), self.country)
            else:
                self.result_file = "{}/{}.csv".format(base_dir, re.sub(r"\s+", "_", self.search_key))
                
            if os.path.exists(self.result_file):
                os.remove(self.result_file)

    def get_config(self):
        with open(base_dir + "/config.json", "r") as config_f:
            config = json.load(config_f)
        
        self.country = config["Country"]
        self.search_key = config["Search"]
        self.page_count = config["PageCount"]

    def start_requests(self):
        yield Request("http://example.com/", callback=self.parseProductURLs)

    def set_driver(self):
        try:
            chrome_options = webdriver.ChromeOptions()
            chrome_options.add_experimental_option("excludeSwitches", ["enable-automation"])  # Hide info bar
            chrome_options.add_experimental_option('useAutomationExtension', False)  # Disable dev mode
            chrome_options.add_argument('--headless')
            chrome_options.add_argument("test-type")
            chrome_options.add_argument("--temp-basedir")
            chrome_options.add_argument("--start-maximized")
            chrome_options.add_argument("--disable-web-security")
            chrome_options.add_argument("--allow-running-insecure-content")
            chrome_options.add_argument('--no-sandbox')
            chrome_options.add_argument('--disable-web-security')
            chrome_options.add_argument('--disable-dev-shm-usage')
            chrome_options.add_argument('--ignore-certificate-errors')
            chrome_options.add_argument("--log-level=3")
            chrome_options.add_argument('--ignore-ssl-errors')
            chrome_options.add_argument("--disable-blink-features")
            chrome_options.add_argument("--disable-blink-features=AutomationControlled")
            chrome_options.add_argument('user-agent=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/59.0.3071.115 Safari/537.36')
            driver = webdriver.Chrome(ChromeDriverManager().install(), options = chrome_options)
            return driver

        except:
            print(traceback.print_exc())
            return None

    def parseProductURLs(self, response):
        try:

            # create webdriver
            self.driver = self.set_driver()
            if self.search_key:
                self.driver.get("https://www.amazon.com/s?k={}&i=mobile&rh=n%3A2335752011%2Cp_36%3A3000-%2Cp_n_condition-type%3A6503240011&dc&qid=1610412022&refresh=2&ref=glow_cls".format(re.sub(r"\s+", "+", self.search_key)))
            else:
                print("Not Found Search Key.")
                print(0 / 0)

            locationSelector = WebDriverWait(self.driver, 30).until(lambda driver: driver.find_element_by_xpath("//a[@id='nav-global-location-popover-link']"))
            time.sleep(1)

            if self.country:
                locationSelector.click()
                time.sleep(3)

                self.driver.find_element_by_xpath("//select[@id='GLUXCountryList']/..").click()
                time.sleep(1)

                self.driver.find_element_by_xpath("//select[@id='GLUXCountryList']/optgroup/option[@value='{}']".format(self.country)).click()
                time.sleep(1)

                self.driver.find_element_by_xpath("//button[@name='glowDoneButton']").click()
                time.sleep(5)
            
            page_index = 1
            while True:
                products = self.driver.find_elements_by_xpath('//span[@data-component-type="s-search-results"]//div[@data-asin]//h2/a[@href]')
                
                for product in products:
                    try:
                        productURL = product.get_attribute("href").split("//")[1].split("/")
                        productLink = "https://{}/{}/{}".format(productURL[0], productURL[2], productURL[3])
                        print(" --- Found Product :", productLink, "--- ")
                        yield Request(productLink, callback=self.parse, headers={"User-Agent": random.choice(user_agent_list)})

                    except:
                        continue

                if self.page_count and page_index >= self.page_count:
                    break

                nextBTN = self.driver.find_element_by_xpath("//ul[@class='a-pagination']/li[@class='a-last']/a")
                if nextBTN:
                    page_index += 1
                    nextBTN.click()
                    time.sleep(5)
                else:
                    break

            

        except:
            print(traceback.print_exc())
        finally:
            if self.driver is not None:
                self.driver.quit()
                self.driver = None
            pass
       
 
    def parse(self, response):
        item = {
            "product_url": response.url,
            "product_name": "",
            "price": "",
            "product_category": "",
            "product_availability": "",
            "product_brand": "",
            "image_url": "",
            "currency": "",
            "shipping_cost": "",
            "estimated_fee": "No Import Fee",
            "ASIN": "",
            "review": "",
            "review_count": "",
            "sales_rank": "",
            "dimension": "",
            "weight": "",
            "ships_from": "",
            "sold_by": "",
            "seller": "",
        }

        try:
            title = re.sub(r"\s+", " ", response.xpath('//h1[@id="title"]/span/text()').get())
            item['product_name'] = re.sub(r"\s+", " ", "".join(title).strip())
        except:
            pass

        try:
            item['price'] = ''.join(response.xpath('//span[contains(@id,"ourprice") or contains(@id,"saleprice")]/text()').extract()).strip()
        except:
            pass

        try:
            item['product_category'] = ','.join(map(lambda x: x.strip(), response.xpath('//a[@class="a-link-normal a-color-tertiary"]/text()').extract())).strip()
        except:
            pass

        try:
            item['product_availability'] = re.sub(r"\s+", " ", ''.join(response.xpath('//div[@id="availability"]//text()').extract()).strip())
        except:
            pass

        try:
            item["product_brand"] = response.xpath("//div[@data-brand]/@data-brand").get().strip()
        except:
            pass

        try:
            if not item["product_brand"]:
                featureList = response.xpath("//div[@id='productOverview_feature_div']//table//tr")
                for feature in featureList:
                    if "Brand" in feature.xpath("./td[1]//text()").get():
                        item["product_brand"] = feature.xpath("./td[last()]//text()").get().strip()
                        break
        except:
            pass

        try:
            item["image_url"] = response.xpath('//img[@id="landingImage"][@data-old-hires]/@data-old-hires').get().strip()
        except:
            pass
        
        try:
            item["currency"] = re.sub(r"[\,\.\d]+", "", item["price"]).strip()
        except:
            pass

        try:
            priceDetails = response.xpath('//div[@id="a-popover-agShipMsgPopover"]/table//tr')
            print(111,response.text.count("a-popover-agShipMsgPopover"))
            print(222,len(response.xpath('//div[@id="a-popover-agShipMsgPopover"]')))
            print(333,len(response.xpath('//div[@id="a-popover-agShipMsgPopover"]/table')))
            print(444,len(response.xpath('//div[@id="a-popover-agShipMsgPopover"]/table//tr')))
            for detail in priceDetails:
                shippingDetails = detail.xpath("./td/span/text()").extract()
                print(shippingDetails)
                if "Shipping" in shippingDetails[0]:
                    item["shipping_cost"] = shippingDetails[-1].strip()

                if "Estimated" in shippingDetails[0]:
                    item["estimated_fee"] = shippingDetails[-1].strip()
        except:
            pass
        
        try:
            item["ASIN"] = response.xpath("//input[@id='all-offers-display-params'][@data-asin]/@data-asin").get().strip()

            if not item["ASIN"]:
                item["ASIN"] = response.xpath("//div[@id='averageCustomerReviews'][@data-asin]/@data-asin").get().strip()
        except:
            pass

        try:
            item["review"] = response.xpath('//table[@id="productDetails_detailBullets_sections1"]//div[@id="averageCustomerReviews"]/../text()').extract()[-1].strip()
        except:
            pass

        try:
            item["review_count"] = "".join(response.xpath('//table[@id="productDetails_detailBullets_sections1"]//div[@id="averageCustomerReviews"]/span[last()]//text()').extract()).strip()
        except:
            pass

        try:
            productInfoList = response.xpath('//table[@id="productDetails_detailBullets_sections1"]//tr')
            for tr in productInfoList:
                try:
                    if "Best Sellers Rank" in tr.xpath("./th//text()").get():
                        item["sales_rank"] = re.search(r"\#[\d,]+", ''.join(tr.xpath("./td//text()").extract())).group()

                    if "Dimension" in tr.xpath("./th//text()").get():
                        item["dimension"] = tr.xpath("./td//text()").get().strip()

                    if "Weight" in tr.xpath("./th//text()").get():
                        item["weight"] = tr.xpath("./td//text()").get().strip()

                except:
                    continue
        except:
            pass

        try:
            buyboxList = response.xpath("//div[@id='tabular-buybox']/table//tr")
            for tr in buyboxList:
                try:
                    if "Ships from" in tr.xpath("./td[1]/span//text()").get():
                        item["ships_from"] = tr.xpath("./td[last()]/span//text()").get().strip()

                    if "Sold by" in tr.xpath("./td[1]/span//text()").get():
                        item["sold_by"] = tr.xpath("./td[last()]/span//text()").get().strip()
                except:
                    continue
        except:
            pass

        try:
            item["seller"] = tr.xpath("//a[@id='sellerProfileTriggerId'][@href]/@href").get().split("seller=")[1].split("&")[0].strip()
        except:
            pass


        print("--------------------------------------------")
        print(json.dumps(item, indent=2))

        file_exist = os.path.exists(self.result_file)

        with open(self.result_file, "a", encoding="utf-8", errors="ignore", newline="") as f:
            fieldnames = ["product_url", "product_name", "price", "product_category", "product_availability", "product_brand", "image_url", "currency", "shipping_cost", "estimated_fee", "ASIN", "review", "review_count", "sales_rank", "dimension", "weight", "ships_from", "sold_by", "seller"]
            writer = csv.DictWriter(f, fieldnames=fieldnames)
            if not file_exist:
                writer.writeheader()

            writer.writerow(item)

        